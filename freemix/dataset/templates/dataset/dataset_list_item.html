{% load i18n %}
{% load freemix_helpers %}

<li class="dataset_list_item result_set_item clearfix {% if dataset.published %}public{% else %}private{% endif %}">

    <div class="dataset-title">
        {% if dataset_url %}
        <a href="{{ dataset_url }}">{{ dataset.title }}</a>
        {% else %}
        {{ dataset.title }}
        {% endif %}
    </div>
    <div class="dataset-description">
        {% if dataset.description %}
                {% ifnotequal dataset.description dataset.description|truncatewords:20 %}
                <span class="short-description">
                {{ dataset.description|safe|truncatewords:20 }}
                    <a class="readmore" href="{{ dataset.get_absolute_url }}">read more</a>
                </span>
                <span class="long-description ui-helper-hidden">
                    {{ dataset.description|safe }}
                </span>
                {%  else %}
                    {{ dataset.description|safe }}
                {% endifnotequal %}
       {% endif %}
    </div>
    <div class="dataset-left">
        <div class="dataset-creator">
          <span class="property-label">{% trans "Loaded by:" %} </span> <a href="{% url profile_detail dataset.owner.username %}">{{ dataset.owner|nicename }}</a>
        </div>
        <div class="dataset-created-data"><span class="property-label">{% trans "Loaded on:" %} </span>{{ dataset.created|date:"N j, Y" }}</div> 
        <div class="dataset-modified-data"><span class="property-label">{% trans "Last Modified:" %} </span>{{ dataset.modified|date:"N j, Y" }}</div>

        {% ifnotequal exhibits.count 0 %}
        <div class="dataset-usedin">
          <span class="property-label">{% trans "Basis for:" %}</span>
          <span class="view-count"><a href="{% url exhibits_by_dataset owner=dataset.owner.username slug=dataset.slug %}">{{ exhibits.count }} {% trans "Data View" %}{{ exhibits.count|pluralize }}</a></span>
        </div>
        {% endifnotequal %}

    </div>

    {% if can_view %}

    <div class="dataset-right">

      <div class="dataset-links">
	
        <span class="action action_inspect_dataset">
          <a class="dataset_inspect" href="{% url dataset_detail owner=dataset.owner.username slug=dataset.slug %}">{% trans "Inspect" %}</a>
        </span>

      {% if can_build %}
        <span class="divider">|</span>

        <span class="action action_create_dataset">
          <a class="dataset_create" href="{% url exhibit_canvas_chooser owner=dataset.owner.username slug=dataset.slug %}">{% trans "Build" %}</a>
        </span>
       {% endif %}

        {% if can_edit %}
        <span class="divider">|</span>

        <span class="action action_edit_dataset">
          <a class="dataset_edit" href="{% url dataset_edit owner=dataset.owner.username slug=dataset.slug %}">{% trans "Edit" %}</a>
        </span>
         {% endif %}

        {% if can_delete %}
        <span class="divider">|</span>

        <span class="action action_edit_dataset">
            <a class="dataset_delete" href="{{ dataset.get_absolute_url }}">{% trans "Delete" %}</a>
        </span>
        {% endif %}

      </div>
    </div>
   {% endif %}

</li>
